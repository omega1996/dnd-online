# Сводка конфигурации доменного имени сервера

## Текущая настройка

Проект настроен для использования доменного имени сервера из переменной окружения `VITE_SERVER_URL`.

## Где используется VITE_SERVER_URL

1. **docker-compose.yml** - передает переменную в Dockerfile при сборке клиента
2. **client/src/App.vue** - использует для HTTP запросов (создание комнат)
3. **client/src/socket.js** - использует для подключения Socket.io
4. **client/src/utils/api.js** - вспомогательные функции для построения URL
5. **Все компоненты** - получают serverUrl через props и используют для API запросов

## Логика работы

- **Если VITE_SERVER_URL установлен** (например, `http://dnd-server.omegasoft.keenetic.name`):
  - Клиент подключается напрямую к этому URL для API запросов
  - Socket.io подключается напрямую к серверу
  - **Файлы (изображения) всегда используют относительные пути** и проксируются через nginx
  
- **Если VITE_SERVER_URL пустой или не установлен**:
  - Клиент использует относительные пути для всех запросов
  - Nginx проксирует все запросы (API, Socket.io, файлы) к бэкенд серверу

**Важно:** Файлы (`/uploads/*`) всегда доступны через относительные пути и проксируются через nginx, независимо от настройки `VITE_SERVER_URL`. Это обеспечивает надежный доступ к файлам и правильную работу CORS.

## Настройка

1. Создайте файл `.env` в корне проекта:
```bash
VITE_SERVER_URL=http://dnd-server.omegasoft.keenetic.name
```

2. Пересоберите и перезапустите контейнеры:
```bash
docker compose up --build -d
```

## Проверка

После пересборки проверьте в браузере (F12 -> Console), что:
- Socket.io подключается к правильному URL
- API запросы идут к правильному домену
- Все запросы работают корректно
